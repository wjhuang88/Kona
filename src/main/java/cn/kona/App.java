package cn.kona;

import cn.kona.protocol.tcp.TCP;
import cn.kona.transport.Cell;
import cn.kona.transport.Pipeline;
import cn.kona.transport.impl.Acceptor;
import java.net.InetSocketAddress;
import java.nio.ByteBuffer;
import java.nio.CharBuffer;
import java.nio.channels.ServerSocketChannel;
import java.nio.charset.Charset;
import kotlin.Unit;
import org.jetbrains.annotations.NotNull;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

/**
 * Generated by ryplat | Wed Sep 13 14:17:33 CST 2017
 */
public class App {

    public App() {
        System.setProperty("log4j2.contextSelector", "org.apache.logging.log4j.core.async.AsyncLoggerContextSelector");
    }

    private static Logger log = LoggerFactory.getLogger("main");

    public static void main(String[] args) throws Exception {
        TCP.create(null, 9999).registerHandler(new TestCell("0")).start();
    }

    static class TestCell implements Cell {

        private String num;

        public TestCell(String num) {
            this.num = num;
        }

        @NotNull
        @Override
        public Object make(@NotNull Object data) {
            CharBuffer decode = Charset.forName("UTF-8").decode((ByteBuffer) data);
            return "added " + num + " data " + decode;
        }
    }
}
